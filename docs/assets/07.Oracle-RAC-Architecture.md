## Oracle RAC Architecture: 

Oracle RAC (Real Application Clusters) architecture is essentially Oracle’s way of making a **single database run on multiple servers** at the same time, giving you scalability and high availability.

Oracle RAC requires Oracle Grid Infrastructure, which includes:
- **Oracle Clusterware**: Provides node membership, cluster management, and high availability features.
- **Oracle ASM (Automatic Storage Management)**: Manages shared storage used by all instances in the RAC cluster.



### Benefits of Oracle RAC:
- **High Availability**: With multiple nodes, if one fails, others can take over, minimizing downtime.
- **Scalability**: Add nodes to increase capacity and handle more transactions without affecting performance.
- **Load Balancing**: Distributes the workload across all nodes, ensuring optimal resource utilization.
- **Fault Tolerance**: Ensures data integrity and availability even in case of hardware failures.



### RAC Architecture: 

![alt text](./assets/10.RAC.png)


### Core Components of Oracle RAC Architecture:

### Cluster Nodes: 
Multiple physical or virtual servers (nodes) work together to handle the database workload.
- Runs its own Oracle Database instance (SGA + background processes)
- Connects to shared storage
- Participates in cluster management through Oracle Clusterware


### Shared Storage:
All nodes in a RAC cluster must access the same database files to ensure consistency, typically stored on a Storage Area Network (SAN) or Network Attached Storage (NAS).

- ASM (Automatic Storage Management) Diskgroups for:
    - Datafiles
    - Control files
    - Online Redo logs
    - Archive logs
- High-performance, redundant storage (SAN, NAS, or cloud-based shared storage)
- Tier 1 storage is critical since all nodes share the I/O path.


### Oracle Clusterware (Oracle Grid Infrastructure):

This foundational component binds the multiple servers into a single cluster. It includes:

1. **Oracle High Availability Services (OHAS)**: OHAS is responsible for starting, stopping, and monitoring Oracle Clusterware components on each node. 
    - **Role**: The foundation of all Oracle Clusterware operations.
    - **Starts first** at OS boot (before CRS, CSS, EVM).
    - Responsible for starting and monitoring:
        - Cluster Synchronization Services (CSS)
        - Oracle Cluster Registry (OCR) access
        - Voting Disk access
        - Grid Plug and Play (GPnP)
        - Multicast DNS (mDNS)
        - Grid IPC (GIPC)
    - Main Daemons:
        - `ohasd.bin` – Core OHAS daemon
        - `gpnpd` – Grid Plug and Play daemon
        - `mdnsd` – Multicast DNS daemon
        - `gipcd` – Grid inter-process communication
        - `orarootagent` – Runs privileged commands
        - `oraagent.bin` – Resource agent for OHAS


2. **Cluster Synchronization Services (CSS)**: Manages cluster membership and node health.
    - **Functionality**:
        - Tracks which nodes are active in the cluster.
        - Detects and fences (evicts) failed or unreachable nodes to avoid split-brain.
    - **Main Process**:
        - `ocssd.bin` – Oracle Cluster Synchronization Service daemon.


3. **Cluster Ready Services (CRS)**: Resource management for cluster-wide Oracle services like databases, instances, and listeners.
    - **Functionality**:
        - Starts, stops, and monitors cluster resources (databases, listeners, VIPs).
        - Performs failover and restart actions on resource failure.
    - **Core Daemons**:
        - `crsd.bin` – CRS daemon; failure triggers node reboot to protect data.
        - `oprocd` – Process monitor daemon; ensures node health at OS level.
        - `oraagent.bin` – Runs resources on behalf of CRS.
        - `oracssdagent` / `oracssdmonitor` – Specialized agents for CSS monitoring.


4. **Event Management (EVM)**: handles cluster events
    - **Functionality**: 
        - Captures and broadcasts cluster events (node join/leave, resource status changes).
        - Interfaces with Oracle Notification Service (ONS) for client-side notifications.
    - **Main Process**:
        - `evmd.bin` – Event manager daemon.
        - `evmlogger` – Logs events for troubleshooting.


5. **Oracle Cluster Registry (OCR)**: Stores cluster configuration information.
    - The OCR stores configuration information about the cluster and the resources it manages, such as information about the nodes, databases, and services. 
    - The OCR is critical for the operation of Oracle Clusterware and must be accessible for the cluster to function. 
    - OCR is mirrored for redundancy, ensuring high availability. 


6. **Voting Disk**: Used to maintain quorum — determines which nodes are allowed to be in the cluster.
    - Stores node membership information.
    - Placed on shared storage (ASM or raw device).
    - Rule of thumb: Always an **odd number of voting disks** for quorum.


#### Clusterware Component Stack (Startup Order):

```
[ Layer 1 ] OHAS (Bootstrap Layer)
    - ohasd.bin
    - gpnpd, mdnsd, gipcd
    - oraagent, orarootagent
    |
[ Layer 2 ] CSS (Cluster Synchronization Services)
    - ocssd.bin
    - Voting disk access
    |
[ Layer 3 ] CRS (Cluster Ready Services)
    - crsd.bin
    - Resource agents
    |
[ Layer 4 ] EVM (Event Manager)
    - evmd.bin
    |
[ Layer 5 ] Oracle Resources
    - ASM instances
    - Database instances
    - Listeners
    - VIPs
```


### Cluster Interconnects:
Each RAC instance runs on a separate node but connects to the same database files. These instances are linked via:
- **Private Network**: Private IPs and network need to provide for both servers to perform Interconnect or heartbeat.
- **Public Network**: 02 Public hostname IPs, 02 VIPs and 03 SCAN IPs are need to be provided for installation.
    - **Public Hostnames/IPs**: normal network access
    - **SCAN (Single Client Access Name)**: A cluster-wide listener configuration allowing clients to connect to any node transparently.
    - **VIPs**: Assigned per node for client failover. If a node fails, the VIP fails over to a surviving node.



### Oracle Kernel Components:
RAC extends the standard Oracle Database kernel with global services for concurrency and data consistency.

#### Global Cache Service (GCS)
- Manages the transfer of cached data blocks between instances via Cache Fusion.
- Ensures read/write consistency across nodes.

#### Global Enqueue Service (GES)
- Coordinates locks for non-cache resources (e.g., dictionary objects).
- Prevents conflicting operations across instances.

#### Cache Fusion
- Instead of reading modified blocks from disk, RAC transfers them over the interconnect from one instance’s buffer cache to another.
- Greatly reduces disk I/O, improving performance.




### RAC Background Processes:
In RAC, background processes fall into two main groups:

- **Standard Oracle DB Processes** – SGA management, redo writing, checkpointing, etc. (same as single instance).
- **RAC-Specific Global Processes** – manage cache coherency, global locks, and inter-instance communication.


#### RAC-Specific Background Processes:

- **LMON** (Lock Monitor)                 
    - Monitors global locks and resource usage across the cluster; detects node failures and initiates global recovery.  

- **LMD** (Lock Manager Daemon)          
    - Handles **Global Enqueue Service (GES)** requests for locks not related to cached data blocks (e.g., library cache locks). Works with LMS for cache operations.  

- **LMS** (Global Cache Service Process) 
     anages **Global Cache Service (GCS)** for block transfers via Cache Fusion; ships blocks between instances using the interconnect. Multiple LMS processes may run for performance. 

- **LCK** (Lock Process)                 
    - Manages instance locks for certain resources, primarily in single-instance but still appears in RAC for compatibility.     

- **DIAG** (Diagnostic Daemon)            
    - Collects and writes diagnostic data when failures occur in RAC processes.    

- **PING** (Network Ping)                 
    - Used in older RAC versions to verify interconnect health; largely replaced by newer GCS/LMS mechanisms.    

- **RMSn** (RAC Management Processes)     
    - Manage Oracle Streams, capture, and apply processes in RAC environments.       

- **RSMN** (Remote Slave Monitor)         
    - Manages creation of slave processes for various RAC background activities.    










### License:
This project is licensed under the MIT License.



